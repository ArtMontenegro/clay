////
/// @group popovers
////

/// A mixin to help create `.popover-header` variants.
/// @param {Map} $map - A map of `key: value` pairs. The keys and value types are listed below:
/// @example
/// (
/// 	enabled: {Bool}, // Set to false to prevent mixin styles from being output. Default: true
/// 	// .popover-header
/// 	before: (
/// 		// .popover-header::before
/// 	),
/// 	after: (
/// 		// .popover-header::after
/// 	),
/// 	empty: (
/// 		// .popover-header:empty
/// 	),
/// 	close: (
/// 		// .popover-header .close
/// 	),
/// )

@mixin clay-popover-header-variant($map) {
	@if (type-of($map) == 'map') {
		$enabled: setter(map-get($map, enabled), true);

		@if ($enabled) {
			@include clay-css($map);

			&::before {
				@include clay-css(map-get($map, before));
			}

			&::after {
				@include clay-css(map-get($map, after));
			}

			&:empty {
				@include clay-css(map-get($map, empty));
			}

			.close {
				@include clay-close(map-get($map, close));
			}
		}
	}
}

/// A mixin to help create `.popover` variants.
/// @param {Map} $map - A map of `key: value` pairs. The keys and value types are listed below:
/// @example
/// (
/// 	enabled: {Bool}, // Set to false to prevent mixin styles from being output. Default: true
/// 	// .popover
/// 	arrow: (
/// 		// .popover .arrow
/// 		before: (
/// 			// .popover .arrow::before
/// 		),
/// 		after: (
/// 			// .popover .arrow::after
/// 		),
/// 	),
/// 	popover-header: (
/// 		// .popover .popover-header
/// 		before: (
/// 			// .popover .popover-header::before
/// 		),
/// 		after: (
/// 			// .popover .popover-header::after
/// 		),
/// 		empty: (
/// 			// .popover .popover-header:empty
/// 		),
/// 	),
/// 	popover-body: (
/// 		// .popover .popover-body
/// 	),
/// 	inline-scroller: (
/// 		// .popover .inline-scroller
/// 	),
/// 	close: (
/// 		// .popover .close
/// 	),
/// )

@mixin clay-popover-variant($map) {
	@if (type-of($map) == 'map') {
		$enabled: setter(map-get($map, enabled), true);

		$focus: setter(map-get($map, focus), ());
		$focus: map-merge(
			$focus,
			(
				background-color:
					setter(
						map-get($map, focus-bg),
						map-get($focus, background-color)
					),
				border-color:
					setter(
						map-get($map, focus-border-color),
						map-get($focus, border-color)
					),
				border-radius:
					setter(
						map-get($map, focus-border-radius),
						map-get($focus, border-radius)
					),
				box-shadow:
					setter(
						map-get($map, focus-box-shadow),
						map-get($focus, box-shadow)
					),
				color:
					setter(map-get($map, focus-color), map-get($focus, color)),
				opacity:
					setter(
						map-get($map, focus-opacity),
						map-get($focus, opacity)
					),
				outline:
					setter(
						map-get($map, focus-outline),
						map-get($focus, outline)
					),
				text-decoration:
					setter(
						map-get($map, focus-text-decoration),
						map-get($focus, text-decoration)
					),
				z-index:
					setter(
						map-get($map, focus-z-index),
						map-get($focus, z-index)
					),
			)
		);

		$_enable-focus-visible: if(
			variable-exists(enable-focus-visible),
			$enable-focus-visible,
			if(
				variable-exists(cadmin-enable-focus-visible),
				$cadmin-enable-focus-visible,
				true
			)
		);

		$_c-prefers-focus-selector: if(
			$_enable-focus-visible,
			'.c-prefers-focus &:focus',
			''
		);

		@if ($enabled) {
			@include clay-css($map);

			.arrow {
				@include clay-css(map-get($map, arrow));

				&::before {
					@include clay-css(map-deep-get($map, arrow, before));
				}

				&::after {
					@include clay-css(map-deep-get($map, arrow, after));
				}
			}

			.popover-header {
				@include clay-popover-header-variant(
					map-get($map, popover-header)
				);
			}

			.popover-body {
				@include clay-css(map-get($map, popover-body));
			}

			.inline-scroller {
				@include clay-css(map-get($map, inline-scroller));
			}

			.close {
				@include clay-close(map-get($map, close));
			}

			@at-root {
				&.focus,
				#{$focus-visible-selector},
				#{$_c-prefers-focus-selector} {
					@include clay-css($focus);

					&::before {
						@include clay-css(map-get($focus, before));
					}

					&::after {
						@include clay-css(map-get($focus, after));
					}

					.inline-item {
						@include clay-css(map-get($focus, inline-item));
					}

					.inline-item-before {
						@include clay-css(map-get($focus, inline-item-before));
					}

					.inline-item-middle {
						@include clay-css(map-get($focus, inline-item-middle));
					}

					.inline-item-after {
						@include clay-css(map-get($focus, inline-item-after));
					}
				}
			}
		}
	}
}
